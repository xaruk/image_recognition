# 画面認識システム開発プロジェクト

## プロジェクト概要
動画対応のリアルタイム画面認識システムをRustで開発する。
最終的にはゲーム画面の状態を認識できるシステムを構築することを目標とする。

## 注意事項

思考は英語で行い、返答は日本語で返すこと。
コードには日本語のコメントを逐次入れること。

## 第一段階：YouTubeチャット認識
手始めに、以下の機能を実装する：

### 基本仕様
- **画面領域指定機能**: クリッピングツールのように、画面上の特定位置を指定可能
- **リアルタイム画像認識**: 指定された領域を常時監視し、画像認識で文字列を読み取り
- **変化検出**: 文字列の変化を検出し、変化分のみを抽出

### 想定使用例
YouTubeのチャット欄を指定し、新しいチャットメッセージが投稿されるたびに文章として生成

## 技術要件

### 必要な機能モジュール
1. **画面キャプチャ**: 指定領域のスクリーンショット取得
2. **画像処理**: キャプチャした画像の前処理
3. **文字認識（OCR）**: 画像から文字列を抽出
4. **変化検出**: 前回の認識結果との差分検出

### 推奨技術スタック
- **言語**: Rust
- **画面キャプチャ**: `screenshots` crate または `winapi`/`x11` による直接実装
- **画像処理**: `image` crate
- **OCR**: `tesseract` バインディング または `paddleocr-rs`
- **非同期処理**: `tokio` でリアルタイム処理

### パフォーマンス考慮事項
- フレームレート: 10-30 FPS程度での画面監視
- メモリ効率: 画像バッファの適切な管理
- CPU使用率: OCR処理の最適化
- 遅延最小化: 認識から読み上げまでの時間短縮

## 実装フェーズ

### フェーズ1: 基本機能実装
1. 画面キャプチャ機能の実装
2. 静的画像でのOCR動作確認
3. 簡単なGUIでの領域指定機能
4. 基本的な音声読み上げ機能

### フェーズ2: リアルタイム処理
1. 定期的な画面監視ループ
2. 文字列変化検出ロジック
3. 非同期処理によるパフォーマンス向上
4. エラーハンドリングとリトライ機能

### フェーズ3: 最適化・拡張
1. OCR精度の向上（前処理の改善）
2. 読み上げ音声の品質向上
3. 設定保存・復元機能
4. 複数領域の同時監視

## 将来の拡張計画
- ゲーム画面の状態認識（HP、スコア、アイテム等）
- 複数の画面要素の同時認識
- 画像認識結果に基づく自動操作
- 機械学習による認識精度の向上

## 技術的な挑戦点
1. **リアルタイム性**: 低遅延でのフレーム処理
2. **OCR精度**: 様々なフォント・背景での文字認識
3. **クロスプラットフォーム**: Windows/macOS/Linux対応
4. **リソース効率**: CPU・メモリ使用量の最適化
5. **ユーザビリティ**: 直感的な領域指定UI

## 開発環境
- Rust 1.70以上
- 対象OS: macOS (開発完了)、Windows 10/11、Linux対応予定

## 開発ガイドライン

### 必須作業フロー
**重要**: すべてのコード変更後は必ずビルドテストを実行すること

```bash
# 必須: 変更後のビルド確認
cargo build --bin main

# 実行テスト
RUST_LOG=info cargo run --bin main
```

### ビルドエラー対処法
1. 依存関係の問題: `cargo clean && cargo build`
2. API変更: 該当crateのドキュメント確認
3. 型エラー: コンパイラメッセージに従って修正

### 現在の安定バージョン
- eframe = "0.28"
- egui = "0.28" 
- screenshots = "0.8"
- tesseract = "0.15"
- tokio = "1.35" (軽量版、rt+macros)

### 完成機能
- ✅ 画面キャプチャ・領域選択
- ✅ OCR（日本語+英語）
- ✅ リアルタイム監視・変化検出
- ✅ GUI（日本語表示対応）
- ✅ 監視開始・停止制御